tukey_hsd(Value ~ Year) %>%
filter(group2 == "2024") %>%
ungroup()
# Create label placement df (for placing on the boxplot)
label_df <- df_abiotic %>%
group_by(Variable, Year) %>%
summarise(y = max(Value, na.rm = TRUE) * 1.05, .groups = "drop") %>%
left_join(
tukey_filtered %>% select(Variable, group1, p.adj.signif),
by = c("Variable", "Year" = "group1")
)
# Replace NAs (which occur for 2024) with "ref"
label_df$p.adj.signif[is.na(label_df$p.adj.signif)] <- "ref"
# Plot with larger font sizes
ggplot(df_abiotic, aes(x = Year, y = Value, fill = Year)) +
geom_boxplot(outlier.shape = 21, outlier.size = 1) +
geom_text(data = label_df, aes(label = p.adj.signif, y = y),
inherit.aes = TRUE, size = 5) +  # Increased from 3.5 to 5
facet_wrap(~ Variable, scales = "free_y") +
theme_classic(base_size = 16) +  # Increases base text size
theme(
axis.text = element_text(size = 14),
axis.title = element_text(size = 16),
strip.text = element_text(size = 16),
plot.title = element_text(size = 18, face = "bold"),
plot.caption = element_text(size = 14)
) +
labs(
x = "Year", y = "Mean Value",
title = "Abiotic Covariates per Fire (2021–2024)\nStatistical Significance vs. 2024",
caption = "* = p < 0.05   ** = p < 0.01   *** = p < 0.001  **** = p < 0.0001   ref = reference group (2024)"
)
# Save the plot
ggsave(
filename = "abiotic_tukey_analysis.png",
path = "C:/Users/allesl/Documents/GitHub/SageBrushFuelModeling_563/Oregon_2024_Plots",
width = 14,
height = 12,
dpi = 300
)
View(abiotic_monthly)
# Load packages
library(tidyverse)
library(lubridate)
# Load data
df <- read_csv("C:/Users/allesl/Documents/Fire_data.csv", show_col_types = FALSE)
# Load packages
library(tidyverse)
library(lubridate)
# Load data
df <- read_csv("C:\Users\allesl\Documents\GitHub\SageBrushFuelModeling_563\Fire_data.csv", show_col_types = FALSE)
# Load packages
library(tidyverse)
library(lubridate)
# Load data
df <- read_csv("C:/Users/allesl/Documents/GitHub/SageBrushFuelModeling_563/Fire_data.csv", show_col_types = FALSE)
# Prepare date and summary columns
df <- df %>%
mutate(
date = as.Date(paste0(Date, "-01")),  # Convert YYYY-MM to Date
year_month = floor_date(date, "month")
) %>%
rename(
ppt = `ppt (mm)`,
tmax = `tmax (degrees C)`,
vpdmax = `vpdmax (hPa)`
)
# List of variables to summarize
vars <- c("ppt", "tmax", "vpdmax")
# Summarize by month and pivot for plotting
df_monthly_avg <- df %>%
group_by(year_month) %>%
summarise(across(all_of(vars), mean, na.rm = TRUE), .groups = "drop") %>%
pivot_longer(cols = all_of(vars), names_to = "Variable", values_to = "Mean Value") %>%
mutate(Variable = recode(Variable,
ppt = "Precipitation (mm)",
tmax = "Max Temperature (°C)",
vpdmax = "VPD Max (hPa)"))
# Plot faceted time series
ggplot(df_monthly_avg, aes(x = year_month, y = `Mean Value`)) +
geom_line(size = 1.2, color = "steelblue") +
facet_wrap(~ Variable, scales = "free_y", ncol = 1) +
scale_x_date(date_breaks = "6 months", date_labels = "%b %Y") +
theme_minimal(base_size = 14) +
theme(
axis.text.x = element_text(angle = 45, hjust = 1),
strip.text = element_text(face = "bold", size = 14)
) +
labs(
title = "Monthly Mean Abiotic Conditions Across Fire Perimeters",
x = "Date",
y = "Mean Value",
caption = "Data aggregated across fire footprints"
)
# Load packages
library(tidyverse)
library(lubridate)
# Load data
df <- read_csv("C:/Users/allesl/Documents/Fire_data.csv", show_col_types = FALSE)
# Load packages
library(tidyverse)
library(lubridate)
# Load data
df <- read_csv("C:/Users/allesl/Documents/GitHub/SageBrushFuelModeling_563/Fire_data.csv", show_col_types = FALSE)
# Prepare date and summary columns
df <- df %>%
mutate(
date = as.Date(paste0(Date, "-01")),
year_month = floor_date(date, "month")
) %>%
filter(year(year_month) %in% 2021:2024) %>%  # <- Restrict to 2021–2024
rename(
ppt = `ppt (mm)`,
tmax = `tmax (degrees C)`,
vpdmax = `vpdmax (hPa)`
)
# List of variables to summarize
vars <- c("ppt", "tmax", "vpdmax")
# Summarize and reshape for plotting
df_monthly_avg <- df %>%
group_by(year_month) %>%
summarise(across(all_of(vars), mean, na.rm = TRUE), .groups = "drop") %>%
pivot_longer(cols = all_of(vars), names_to = "Variable", values_to = "Mean Value") %>%
mutate(Variable = recode(Variable,
ppt = "Precipitation (mm)",
tmax = "Max Temperature (°C)",
vpdmax = "VPD Max (hPa)"))
# Faceted time series plot
ggplot(df_monthly_avg, aes(x = year_month, y = `Mean Value`)) +
geom_line(size = 1.2, color = "steelblue") +
facet_wrap(~ Variable, scales = "free_y", ncol = 1) +
scale_x_date(date_breaks = "3 months", date_labels = "%b %Y") +
theme_minimal(base_size = 14) +
theme(
axis.text.x = element_text(angle = 45, hjust = 1),
strip.text = element_text(face = "bold", size = 14)
) +
labs(
title = "Monthly Mean Abiotic Conditions (2021–2024)",
x = "Date",
y = "Mean Value",
caption = "Data aggregated across fire footprints"
)
library(tidyverse)
library(lubridate)
# Load data from your project directory
df <- read_csv("C:/Users/allesl/Documents/GitHub/SageBrushFuelModeling_563/Fire_data.csv", show_col_types = FALSE)
# Format and filter
df <- df %>%
mutate(
date = as.Date(paste0(Date, "-01")),
year_month = floor_date(date, "month"),
month = month(date, label = TRUE, abbr = TRUE),
year = year(date)
) %>%
filter(year %in% 2021:2024, month(date) %in% 1:8) %>%  # Jan to Aug only
rename(
ppt = `ppt (mm)`,
tmax = `tmax (degrees C)`,
vpdmax = `vpdmax (hPa)`
)
# Variables to summarize
vars <- c("ppt", "tmax", "vpdmax")
# Summarize monthly averages across fires
df_monthly_bar <- df %>%
group_by(year, month) %>%
summarise(across(all_of(vars), mean, na.rm = TRUE), .groups = "drop") %>%
pivot_longer(cols = all_of(vars), names_to = "Variable", values_to = "Mean Value") %>%
mutate(Variable = recode(Variable,
ppt = "Precipitation (mm)",
tmax = "Max Temperature (°C)",
vpdmax = "VPD Max (hPa)"))
# Plot: grouped bars by year within each month
ggplot(df_monthly_bar, aes(x = month, y = `Mean Value`, fill = factor(year))) +
geom_col(position = position_dodge(width = 0.8)) +
facet_wrap(~ Variable, scales = "free_y", ncol = 1) +
scale_fill_brewer(palette = "Dark2", name = "Year") +
theme_minimal(base_size = 14) +
labs(
title = "Jan–Aug Monthly Mean Abiotic Conditions by Year",
x = "Month",
y = "Mean Value",
caption = "Data aggregated across fire footprints (2021–2024)"
) +
theme(
axis.text.x = element_text(size = 12),
strip.text = element_text(face = "bold", size = 14),
legend.position = "top"
)
library(tidyverse)
library(lubridate)
# Load the fire data
df <- read_csv("C:/Users/allesl/Documents/GitHub/SageBrushFuelModeling_563/Fire_data.csv", show_col_types = FALSE)
# Prepare the data
df <- df %>%
mutate(
date = as.Date(paste0(Date, "-01")),
year = year(date),
month = month(date),
month_label = month(date, label = TRUE, abbr = TRUE)
) %>%
filter(year %in% 2021:2024, month %in% 3:8) %>%
rename(
FIRE_ID = Name,
ppt = `ppt (mm)`,
tmax = `tmax (degrees C)`,
vpdmax = `vpdmax (hPa)`
)
# List of variables to plot
vars <- c("ppt", "tmax", "vpdmax")
# Reshape data: long format for plotting
df_long <- df %>%
pivot_longer(cols = all_of(vars), names_to = "Variable", values_to = "Value") %>%
mutate(Variable = recode(Variable,
ppt = "Precipitation (mm)",
tmax = "Max Temperature (°C)",
vpdmax = "VPD Max (hPa)"))
# Create scatter plot
ggplot(df_long, aes(x = month_label, y = Value, color = month_label)) +
geom_jitter(width = 0.2, alpha = 0.8, size = 2) +
facet_grid(Variable ~ year, scales = "free_y") +
scale_color_brewer(palette = "Dark2", name = "Month") +
theme_minimal(base_size = 14) +
labs(
title = "March–August Abiotic Conditions by Fire, Faceted by Year",
x = "Month",
y = "Mean Value per Fire",
caption = "Each point represents a fire's average value for that month and variable"
) +
theme(
strip.text = element_text(face = "bold", size = 12),
axis.text.x = element_text(size = 12)
)
library(tidyverse)
library(lubridate)
# Load data
df <- read_csv("C:/Users/allesl/Documents/GitHub/SageBrushFuelModeling_563/Fire_data.csv", show_col_types = FALSE)
# Prepare and filter
df <- df %>%
mutate(
date = as.Date(paste0(Date, "-01")),
year = year(date),
month = month(date),
month_label = month(date, label = TRUE, abbr = TRUE)
) %>%
filter(year %in% 2021:2024, month %in% 3:8) %>%
rename(
FIRE_ID = Name,
ppt = `ppt (mm)`,
tmax = `tmax (degrees C)`,
vpdmax = `vpdmax (hPa)`
)
# Convert to long format for heatmap
df_long <- df %>%
select(FIRE_ID, year, month_label, ppt, tmax, vpdmax) %>%
pivot_longer(cols = c(ppt, tmax, vpdmax), names_to = "Variable", values_to = "Value") %>%
mutate(
Variable = recode(Variable,
ppt = "Precipitation (mm)",
tmax = "Max Temperature (°C)",
vpdmax = "VPD Max (hPa)"),
fire_label = paste0(FIRE_ID, " (", year, ")")  # Unique label for heatmap rows
)
# Plot heatmap
ggplot(df_long, aes(x = month_label, y = reorder(fire_label, desc(fire_label)), fill = Value)) +
geom_tile(color = "white", linewidth = 0.2) +
facet_wrap(~ Variable, scales = "free") +
scale_fill_viridis_c(option = "D", name = "Value") +
labs(
title = "March–August Abiotic Conditions by Fire and Month",
subtitle = "Each row represents one fire-year observation",
x = "Month",
y = "Fire (Year)"
) +
theme_minimal(base_size = 14) +
theme(
axis.text.x = element_text(size = 12),
axis.text.y = element_text(size = 10),
strip.text = element_text(face = "bold", size = 14)
)
library(tidyverse)
library(lubridate)
# Load your data
df <- read_csv("C:/Users/allesl/Documents/GitHub/SageBrushFuelModeling_563/Fire_data.csv", show_col_types = FALSE)
# Format and filter
df <- df %>%
mutate(
date = as.Date(paste0(Date, "-01")),
year = year(date),
month = month(date),
month_label = month(date, label = TRUE, abbr = TRUE)
) %>%
filter(year %in% 2021:2024, month %in% 3:8) %>%
rename(
FIRE_ID = Name,
ppt = `ppt (mm)`,
tmax = `tmax (degrees C)`,
vpdmax = `vpdmax (hPa)`
)
# Make compact fire labels
df <- df %>%
mutate(fire_label = paste0(str_sub(FIRE_ID, 1, 10), " (", year, ")"))
# Pivot to long format for heatmap plotting
df_long <- df %>%
select(fire_label, month_label, ppt, tmax, vpdmax) %>%
pivot_longer(cols = c(ppt, tmax, vpdmax), names_to = "Variable", values_to = "Value") %>%
mutate(
Variable = recode(Variable,
ppt = "Precipitation (mm)",
tmax = "Max Temperature (°C)",
vpdmax = "VPD Max (hPa)")
)
# OPTIONAL: reorder fire labels by mean VPD max
fire_order <- df_long %>%
filter(Variable == "VPD Max (hPa)") %>%
group_by(fire_label) %>%
summarise(mean_vpd = mean(Value, na.rm = TRUE)) %>%
arrange(desc(mean_vpd)) %>%
pull(fire_label)
df_long$fire_label <- factor(df_long$fire_label, levels = fire_order)
# Plot heatmap: fire x-axis, month y-axis
ggplot(df_long, aes(x = fire_label, y = month_label, fill = Value)) +
geom_tile(color = "white", linewidth = 0.2) +
facet_wrap(~ Variable, scales = "free") +
scale_fill_viridis_c(option = "D", name = "Value") +
labs(
title = "March–August Abiotic Conditions by Fire and Month",
subtitle = "Fires limited to 2021–2024; values ordered by mean VPD Max",
x = "Fire (Year)",
y = "Month"
) +
theme_minimal(base_size = 14) +
theme(
axis.text.x = element_text(angle = 90, size = 10, vjust = 0.5, hjust = 1),
axis.text.y = element_text(size = 12),
strip.text = element_text(face = "bold", size = 14)
)
library(tidyverse)
library(lubridate)
# Load your biotic + abiotic fire data
df <- read_csv("C:/Users/allesl/Documents/GitHub/SageBrushFuelModeling_563/Fire_data.csv", show_col_types = FALSE)
# Format
df <- df %>%
mutate(
date = as.Date(paste0(Date, "-01")),
year = year(date),
month = month(date)
) %>%
filter(year %in% 2021:2024, month %in% 3:8) %>%
rename(
ppt = `ppt (mm)`,
tmax = `tmax (degrees C)`,
vpdmax = `vpdmax (hPa)`,
AFG = `AFG`,
PFG = `PFG`,
SHR = `SHR`,
TRE = `TRE`
)
library(tidyverse)
library(lubridate)
# ==== Load ABIOTIC data ====
abiotic_df <- read_csv("C:/Users/allesl/Documents/GitHub/SageBrushFuelModeling_563/Fire_data.csv", show_col_types = FALSE)
abiotic_df <- abiotic_df %>%
mutate(
date = as.Date(paste0(Date, "-01")),
year = year(date),
month = month(date)
) %>%
filter(year %in% 2021:2024, month %in% 3:8) %>%
rename(
ppt = `ppt (mm)`,
tmax = `tmax (degrees C)`,
vpdmax = `vpdmax (hPa)`
) %>%
group_by(year) %>%
summarise(across(c(ppt, tmax, vpdmax), mean, na.rm = TRUE), .groups = "drop") %>%
pivot_longer(-year, names_to = "Variable", values_to = "Value") %>%
mutate(Group = "Abiotic")
# ==== Load BIOTIC data ====
biotic_df <- read_csv("C:/Users/allesl/Documents/GitHub/SageBrushFuelModeling_563/ZonalStats_AFG_PFG_SHR_TRE_ByFireArea_2021_2024.csv", show_col_types = FALSE)
biotic_df <- biotic_df %>%
group_by(year) %>%
summarise(across(c(AFG, PFG, SHR, TRE), mean, na.rm = TRUE), .groups = "drop") %>%
pivot_longer(-year, names_to = "Variable", values_to = "Value") %>%
mutate(Group = "Biotic")
# ==== Combine & Standardize ====
combined_df <- bind_rows(abiotic_df, biotic_df) %>%
group_by(Variable) %>%
mutate(z_score = scale(Value)[, 1]) %>%
ungroup()
# ==== Plot ====
ggplot(combined_df, aes(x = year, y = z_score, color = Variable, group = Variable)) +
geom_line(linewidth = 1.2) +
geom_point(size = 2.5) +
facet_wrap(~ Group, scales = "free_y") +
scale_color_brewer(palette = "Set1") +
theme_minimal(base_size = 14) +
labs(
title = "Standardized Annual Trends in Abiotic and Biotic Conditions",
subtitle = "March–August mean values across fire footprints (2021–2024)",
x = "Year",
y = "Z-score (standardized)",
color = "Variable"
)
library(tidyverse)
library(lubridate)
# ==== Load ABIOTIC data (monthly) ====
abiotic_df <- read_csv("C:/Users/allesl/Documents/GitHub/SageBrushFuelModeling_563/Fire_data.csv", show_col_types = FALSE)
abiotic_df <- abiotic_df %>%
mutate(
date = as.Date(paste0(Date, "-01")),
year = year(date),
month = month(date),
month_label = month(date, label = TRUE, abbr = TRUE)
) %>%
filter(year %in% 2021:2024, month %in% 1:12) %>%
rename(
ppt = `ppt (mm)`,
tmax = `tmax (degrees C)`,
vpdmax = `vpdmax (hPa)`
)
abiotic_long <- abiotic_df %>%
group_by(date) %>%
summarise(across(c(ppt, tmax, vpdmax), mean, na.rm = TRUE), .groups = "drop") %>%
pivot_longer(cols = c(ppt, tmax, vpdmax), names_to = "Variable", values_to = "Value") %>%
mutate(Variable = recode(Variable,
ppt = "Precipitation (mm)",
tmax = "Max Temperature (°C)",
vpdmax = "VPD Max (hPa)"))
# ==== Load BIOTIC data (annual AFG) ====
biotic_df <- read_csv("C:/Users/allesl/Documents/GitHub/SageBrushFuelModeling_563/ZonalStats_AFG_PFG_SHR_TRE_ByFireArea_2021_2024.csv", show_col_types = FALSE)
biotic_annual <- biotic_df %>%
group_by(year) %>%
summarise(AFG = mean(AFG, na.rm = TRUE), .groups = "drop") %>%
mutate(
Variable = "AFG Cover (%)",
date = as.Date(paste0(year, "-07-01")),  # place AFG mid-year
Value = AFG
) %>%
select(date, Variable, Value)
# ==== Combine data ====
plot_data <- bind_rows(abiotic_long, biotic_annual)
# ==== Plot ====
ggplot(plot_data, aes(x = date, y = Value, color = Variable, group = Variable)) +
geom_line(data = filter(plot_data, Variable != "AFG Cover (%)"), size = 1.2) +
geom_point(data = filter(plot_data, Variable == "AFG Cover (%)"), size = 3) +
facet_wrap(~ Variable, scales = "free_y", ncol = 1) +
scale_x_date(date_breaks = "3 months", date_labels = "%b\n%Y") +
theme_minimal(base_size = 14) +
labs(
title = "Monthly Abiotic and Annual AFG Trends (2021–2024)",
subtitle = "Abiotic values are monthly means; AFG shown once per year",
x = "Date",
y = "Raw Value",
color = "Variable"
) +
theme(
strip.text = element_text(size = 14, face = "bold"),
axis.text.x = element_text(angle = 45, hjust = 1)
)
library(tidyverse)
library(lubridate)
# === Load ABIOTIC data ===
abiotic_df <- read_csv("C:/Users/allesl/Documents/GitHub/SageBrushFuelModeling_563/Fire_data.csv", show_col_types = FALSE)
abiotic_df <- abiotic_df %>%
mutate(
date = as.Date(paste0(Date, "-01")),
year = year(date),
month = month(date)
) %>%
filter(year %in% 2021:2023, month %in% 3:6) %>%
rename(
ppt = `ppt (mm)`,
tmax = `tmax (degrees C)`,
vpdmax = `vpdmax (hPa)`
)
abiotic_long <- abiotic_df %>%
pivot_longer(cols = c(ppt, tmax, vpdmax), names_to = "Variable", values_to = "Value") %>%
mutate(
Variable = recode(Variable,
ppt = "Precipitation (mm)",
tmax = "Max Temperature (°C)",
vpdmax = "VPD Max (hPa)")
)
# === Load BIOTIC AFG data ===
biotic_df <- read_csv("C:/Users/allesl/Documents/GitHub/SageBrushFuelModeling_563/ZonalStats_AFG_PFG_SHR_TRE_ByFireArea_2021_2024.csv", show_col_types = FALSE)
afg_summary <- biotic_df %>%
filter(year %in% 2021:2023) %>%
group_by(year) %>%
summarise(Value = mean(AFG, na.rm = TRUE), .groups = "drop") %>%
mutate(Variable = "AFG Cover (%)")
# === Combine for plotting ===
plot_df <- bind_rows(
abiotic_long %>% select(year, Variable, Value),
afg_summary
)
# === Plot: one facet per year ===
ggplot(plot_df, aes(x = Variable, y = Value, fill = Variable)) +
geom_boxplot(data = filter(plot_df, Variable != "AFG Cover (%)"), alpha = 0.6, outlier.shape = NA) +
geom_col(data = filter(plot_df, Variable == "AFG Cover (%)"), width = 0.6, color = "black") +
facet_wrap(~ year, ncol = 1, scales = "free_y") +
theme_minimal(base_size = 14) +
labs(
title = "Abiotic Boxplots (March–June) and Annual AFG Cover (2021–2023)",
x = "Variable",
y = "Raw Value",
caption = "Boxplots show monthly abiotic data; bars show annual AFG cover"
) +
theme(
strip.text = element_text(size = 14, face = "bold"),
legend.position = "none"
)
